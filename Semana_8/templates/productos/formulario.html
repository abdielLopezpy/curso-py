{# ============================================================================
   FORMULARIO DE PRODUCTO
   ============================================================================
   Formulario reutilizable para CREAR y EDITAR productos.

   CÓMO FUNCIONA:
   - Si 'producto' existe → es EDICIÓN (los campos tienen valores)
   - Si 'producto' no existe → es CREACIÓN (los campos están vacíos)

   DATOS RECIBIDOS DESDE PYTHON:
   - producto: objeto Producto (solo en edición)
   - categorias: lista de categorías para el select

   PARA CREAR UN FORMULARIO SIMILAR:
   1. Copia este archivo a templates/tu_entidad/formulario.html
   2. Cambia los campos del formulario
   3. Actualiza las URLs
   ============================================================================ #}

{% extends "base.html" %}

{# Importar los macros de formulario #}
{% from "macros.html" import campo_texto, campo_numero, campo_textarea, campo_select, boton %}

{% block title %}
    {# Título dinámico según si es crear o editar #}
    {% if producto %}Editar{% else %}Nuevo{% endif %} Producto - Flask + Neon
{% endblock %}

{% block content %}

{# ============================================================================
   TÍTULO
   ============================================================================ #}
<h1>{% if producto %}Editar{% else %}Nuevo{% endif %} Producto</h1>


{# ============================================================================
   FORMULARIO
   ============================================================================
   - method="POST": los datos se envían al servidor
   - La acción se determina por la URL actual
   - Usamos macros para generar los campos
   ============================================================================ #}
<div class="card">
    <div class="card-body">
        <form method="POST" class="form">

            {# ----------------------------------------------------------------
               CAMPO: Nombre
               ----------------------------------------------------------------
               campo_texto(name, label, value, type, placeholder, required, help_text)
               ---------------------------------------------------------------- #}
            {{ campo_texto(
                'nombre',
                'Nombre del producto',
                value=producto.nombre if producto else '',
                placeholder='Ej: Laptop Gaming, Mouse Inalámbrico...',
                required=true
            ) }}

            {# ----------------------------------------------------------------
               CAMPO: Descripción
               ----------------------------------------------------------------
               campo_textarea(name, label, value, rows, placeholder, required)
               ---------------------------------------------------------------- #}
            {{ campo_textarea(
                'descripcion',
                'Descripción',
                value=producto.descripcion if producto else '',
                placeholder='Descripción detallada del producto...',
                rows=4
            ) }}

            {# ----------------------------------------------------------------
               CAMPO: Precio
               ----------------------------------------------------------------
               campo_numero(name, label, value, min, max, step, required)
               step='0.01' permite decimales
               ---------------------------------------------------------------- #}
            {{ campo_numero(
                'precio',
                'Precio',
                value=producto.precio if producto else '',
                min=0,
                step='0.01',
                required=true
            ) }}

            {# ----------------------------------------------------------------
               CAMPO: Stock
               ---------------------------------------------------------------- #}
            {{ campo_numero(
                'stock',
                'Stock',
                value=producto.stock if producto else 0,
                min=0
            ) }}

            {# ----------------------------------------------------------------
               CAMPO: Categoría (select)
               ----------------------------------------------------------------
               campo_select(name, label, options, value_attr, text_attr, selected, placeholder, required)
               ---------------------------------------------------------------- #}
            {{ campo_select(
                'categoria_id',
                'Categoría',
                categorias,
                selected=producto.categoria_id if producto else None,
                placeholder='-- Sin categoría --'
            ) }}

            {# ----------------------------------------------------------------
               BOTONES DE ACCIÓN
               ---------------------------------------------------------------- #}
            <div class="form-actions">
                {# Botón submit - el texto cambia según crear/editar #}
                {{ boton(
                    'Guardar Cambios' if producto else 'Crear Producto',
                    'success',
                    submit=true
                ) }}

                {# Botón cancelar - enlace a la lista #}
                {{ boton('Cancelar', 'secondary', url=url_for('listar_productos')) }}
            </div>

        </form>
    </div>
</div>


{# ============================================================================
   NOTAS PARA AGREGAR CAMPOS
   ============================================================================

   1. AGREGAR UN CAMPO DE TEXTO:
      {{ campo_texto('mi_campo', 'Etiqueta', value=objeto.mi_campo if objeto else '') }}

   2. AGREGAR UN CAMPO NUMÉRICO:
      {{ campo_numero('cantidad', 'Cantidad', min=0, max=100) }}

   3. AGREGAR UN TEXTAREA:
      {{ campo_textarea('notas', 'Notas adicionales', rows=3) }}

   4. AGREGAR UN SELECT:
      {{ campo_select('categoria_id', 'Categoría', lista_opciones) }}

   5. AGREGAR UN CHECKBOX:
      {{ campo_checkbox('activo', 'Está activo', checked=objeto.activo) }}

   RECUERDA:
   - Agregar la columna correspondiente en el modelo (app_flask.py)
   - Procesar el campo en la ruta: request.form['mi_campo']

   ============================================================================ #}

{% endblock %}
